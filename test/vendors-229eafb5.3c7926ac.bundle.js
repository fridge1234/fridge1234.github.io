"use strict";(self.webpackChunkouterspace_webpack=self.webpackChunkouterspace_webpack||[]).push([[923],{3379:e=>{var t=[];function s(e){for(var s=-1,n=0;n<t.length;n++)if(t[n].identifier===e){s=n;break}return s}function n(e,n){for(var o={},i=[],a=0;a<e.length;a++){var l=e[a],c=n.base?l[0]+n.base:l[0],u=o[c]||0,h="".concat(c," ").concat(u);o[c]=u+1;var p=s(h),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(d);else{var m=r(d,n);n.byIndex=a,t.splice(a,0,{identifier:h,updater:m,references:1})}i.push(h)}return i}function r(e,t){var s=t.domAPI(t);s.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,r){var o=n(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var a=s(o[i]);t[a].references--}for(var l=n(e,r),c=0;c<o.length;c++){var u=s(o[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=l}}},569:e=>{var t={};e.exports=function(e,s){var n=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(s)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,s)=>{e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var n="";s.supports&&(n+="@supports (".concat(s.supports,") {")),s.media&&(n+="@media ".concat(s.media," {"));var r=void 0!==s.layer;r&&(n+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),n+=s.css,r&&(n+="}"),s.media&&(n+="}"),s.supports&&(n+="}");var o=s.sourceMap;o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},8719:(e,t,s)=>{s.d(t,{H:()=>r});var n=s(1051);class r extends n.c{constructor(e=[]){super(),this.cameras=e}}r.prototype.isArrayCamera=!0},1929:(e,t,s)=>{s.d(t,{V:()=>o});var n=s(9203),r=s(6469);class o extends r.T{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new n.y,this.projectionMatrix=new n.y,this.projectionMatrixInverse=new n.y}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}o.prototype.isCamera=!0},2496:(e,t,s)=>{s.d(t,{_:()=>a});var n=s(6469),r=s(6881),o=s(1051);const i=90;class a extends n.T{constructor(e,t,s){if(super(),this.type="CubeCamera",!0!==s.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=s;const n=new o.c(i,1,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new r.P(1,0,0)),this.add(n);const a=new o.c(i,1,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new r.P(-1,0,0)),this.add(a);const l=new o.c(i,1,e,t);l.layers=this.layers,l.up.set(0,0,1),l.lookAt(new r.P(0,1,0)),this.add(l);const c=new o.c(i,1,e,t);c.layers=this.layers,c.up.set(0,0,-1),c.lookAt(new r.P(0,-1,0)),this.add(c);const u=new o.c(i,1,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new r.P(0,0,1)),this.add(u);const h=new o.c(i,1,e,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new r.P(0,0,-1)),this.add(h)}update(e,t){null===this.parent&&this.updateMatrixWorld();const s=this.renderTarget,[n,r,o,i,a,l]=this.children,c=e.xr.enabled,u=e.getRenderTarget();e.xr.enabled=!1;const h=s.texture.generateMipmaps;s.texture.generateMipmaps=!1,e.setRenderTarget(s,0),e.render(t,n),e.setRenderTarget(s,1),e.render(t,r),e.setRenderTarget(s,2),e.render(t,o),e.setRenderTarget(s,3),e.render(t,i),e.setRenderTarget(s,4),e.render(t,a),s.texture.generateMipmaps=h,e.setRenderTarget(s,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=c}}},3131:(e,t,s)=>{s.d(t,{i:()=>r});var n=s(1929);class r extends n.V{constructor(e=-1,t=1,s=1,n=-1,r=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=s,this.bottom=n,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,s,n,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=s,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),s=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=s-e,o=s+e,i=n+t,a=n-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,o=r+e*this.view.width,i-=t*this.view.offsetY,a=i-t*this.view.height}this.projectionMatrix.makeOrthographic(r,o,i,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}r.prototype.isOrthographicCamera=!0},1051:(e,t,s)=>{s.d(t,{c:()=>o});var n=s(1929),r=s(2043);class o extends n.V{constructor(e=50,t=1,s=.1,n=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=s,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*r.I3*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*r.qW*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*r.I3*Math.atan(Math.tan(.5*r.qW*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,s,n,r,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=s,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*r.qW*this.fov)/this.zoom,s=2*t,n=this.aspect*s,o=-.5*n;const i=this.view;if(null!==this.view&&this.view.enabled){const e=i.fullWidth,r=i.fullHeight;o+=i.offsetX*n/e,t-=i.offsetY*s/r,n*=i.width/e,s*=i.height/r}const a=this.filmOffset;0!==a&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+n,t,t-s,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}o.prototype.isPerspectiveCamera=!0},1661:(e,t,s)=>{s.d(t,{UZH:()=>n,RsA:()=>r,QmN:()=>o,PeU:()=>i,tm_:()=>a,S2y:()=>l,_iA:()=>c,ntZ:()=>u,dwk:()=>h,Wl3:()=>p,_Li:()=>d,ehD:()=>m,esl:()=>f,jFi:()=>g,bdR:()=>y,WMw:()=>v,N4l:()=>T,M5h:()=>b,Xaj:()=>x,bGH:()=>E,Wbm:()=>w,rOj:()=>_,r_:()=>M,Sm8:()=>A,c8b:()=>R,ghN:()=>S,KhW:()=>N,iWC:()=>P,k74:()=>I,LgZ:()=>L,fSK:()=>O,Hy8:()=>C,Vdb:()=>k,Wpd:()=>F,RlZ:()=>H,BVF:()=>j,Se2:()=>U,Zr5:()=>V,vCF:()=>D,eD:()=>B,ksN:()=>G,w$m:()=>z,M6v:()=>K,Ns1:()=>W,qhX:()=>Y,NDo:()=>X,uL9:()=>q,EoG:()=>Z,CdI:()=>J,YGz:()=>Q,LY2:()=>$,dZ3:()=>ee,xfE:()=>te,fY$:()=>se,vxC:()=>ne,dSO:()=>re,Bf4:()=>oe,g8_:()=>ie,SVc:()=>ae,rpg:()=>le,uWy:()=>ce,OoA:()=>ue,TyD:()=>he,YLQ:()=>pe,aH4:()=>de,wem:()=>me,qyh:()=>fe,D1R:()=>ge,ywz:()=>ye,T95:()=>ve,iAb:()=>Te,LsT:()=>be,Kz5:()=>xe,JQ4:()=>Ee,VzW:()=>we,cLu:()=>_e,k0A:()=>Me,irR:()=>Ae,XNv:()=>Re,wJv:()=>Se,OTo:()=>Ne,UCm:()=>Pe,wk1:()=>Ie,Y8D:()=>Le,cRx:()=>Oe,aoB:()=>Ce,qkB:()=>ke,brP:()=>Fe,hEm:()=>He,D9w:()=>je,av9:()=>Ue,CtA:()=>Ve,F5G:()=>De,E2K:()=>Be,wuA:()=>Ge,BFQ:()=>ze,v3W:()=>Ke,ILR:()=>We,_AM:()=>Ye,vCx:()=>Xe,eaV:()=>qe,CaW:()=>Ze,fto:()=>Je,l0P:()=>Qe,ekQ:()=>$e,ptH:()=>et,jZA:()=>tt,y2t:()=>st,gi4:()=>nt,Djp:()=>rt,BG$:()=>ot,NYV:()=>it,xJs:()=>at,pKu:()=>lt,GG6:()=>ct,Gih:()=>ut,FUD:()=>ht,iiP:()=>pt,SvJ:()=>dt,bsb:()=>mt,APR:()=>ft,Abz:()=>gt,v6B:()=>yt,pnl:()=>vt,OS$:()=>Tt,_wO:()=>bt,bcs:()=>xt,Y5S:()=>Et,Wso:()=>wt,p1$:()=>_t,I0h:()=>Mt,Yjz:()=>At,ePn:()=>Rt,HBG:()=>St,Syv:()=>Nt,NMF:()=>Pt,pIN:()=>It,Pnf:()=>Lt,_lf:()=>Ot,_sL:()=>Ct,IFH:()=>kt,gSk:()=>Ft,UlW:()=>Ht,z$h:()=>jt,rnI:()=>Ut,knz:()=>Vt,pMV:()=>Dt,KC9:()=>Bt,LgE:()=>Gt,Inb:()=>zt,gMp:()=>Kt,z81:()=>Wt,mSO:()=>Yt,IOt:()=>Xt,PA7:()=>qt,x5V:()=>Zt,cum:()=>Jt,W2J:()=>Qt,LSk:()=>$t});const n="135",r={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},i=0,a=1,l=2,c=1,u=2,h=3,p=0,d=1,m=2,f=1,g=0,y=1,v=2,T=3,b=4,x=5,E=100,w=101,_=102,M=103,A=104,R=200,S=201,N=202,P=203,I=204,L=205,O=206,C=207,k=208,F=209,H=210,j=0,U=1,V=2,D=3,B=4,G=5,z=6,K=7,W=0,Y=1,X=2,q=0,Z=1,J=2,Q=3,$=4,ee=5,te=300,se=301,ne=302,re=303,oe=304,ie=306,ae=307,le=1e3,ce=1001,ue=1002,he=1003,pe=1004,de=1005,me=1006,fe=1007,ge=1008,ye=1009,ve=1010,Te=1011,be=1012,xe=1013,Ee=1014,we=1015,_e=1016,Me=1017,Ae=1018,Re=1019,Se=1020,Ne=1021,Pe=1022,Ie=1023,Le=1024,Oe=1025,Ce=Ie,ke=1026,Fe=1027,He=1028,je=1029,Ue=1030,Ve=1031,De=1032,Be=1033,Ge=33776,ze=33777,Ke=33778,We=33779,Ye=35840,Xe=35841,qe=35842,Ze=35843,Je=36196,Qe=37492,$e=37496,et=37808,tt=37809,st=37810,nt=37811,rt=37812,ot=37813,it=37814,at=37815,lt=37816,ct=37817,ut=37818,ht=37819,pt=37820,dt=37821,mt=36492,ft=37840,gt=37841,yt=37842,vt=37843,Tt=37844,bt=37845,xt=37846,Et=37847,wt=37848,_t=37849,Mt=37850,At=37851,Rt=37852,St=37853,Nt=2300,Pt=2301,It=2302,Lt=2400,Ot=2401,Ct=2402,kt=2500,Ft=2501,Ht=1,jt=2,Ut=3e3,Vt=3001,Dt=3007,Bt=3002,Gt=3004,zt=3005,Kt=3006,Wt=3200,Yt=3201,Xt=0,qt=1,Zt=7680,Jt=519,Qt=35044,$t="300 es"},9365:(e,t,s)=>{s.d(t,{z:()=>p});var n=s(7406),r=s(6881),o=s(1661),i=s(7092),a=s(6214),l=s(1138);const c={type:"change"},u={type:"start"},h={type:"end"};class p extends n.p{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new r.P,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:o.RsA.ROTATE,MIDDLE:o.RsA.DOLLY,RIGHT:o.RsA.PAN},this.touches={ONE:o.QmN.ROTATE,TWO:o.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",J),this._domElementKeyEvents=e},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),p=n.NONE},this.update=function(){const t=new r.P,o=(new i._).setFromUnitVectors(e.up,new r.P(0,1,0)),a=o.clone().invert(),l=new r.P,u=new i._,h=2*Math.PI;return function(){const e=s.object.position;t.copy(e).sub(s.target),t.applyQuaternion(o),m.setFromVector3(t),s.autoRotate&&p===n.NONE&&I(2*Math.PI/60/60*s.autoRotateSpeed),s.enableDamping?(m.theta+=f.theta*s.dampingFactor,m.phi+=f.phi*s.dampingFactor):(m.theta+=f.theta,m.phi+=f.phi);let r=s.minAzimuthAngle,i=s.maxAzimuthAngle;return isFinite(r)&&isFinite(i)&&(r<-Math.PI?r+=h:r>Math.PI&&(r-=h),i<-Math.PI?i+=h:i>Math.PI&&(i-=h),m.theta=r<=i?Math.max(r,Math.min(i,m.theta)):m.theta>(r+i)/2?Math.max(r,m.theta):Math.min(i,m.theta)),m.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=g,m.radius=Math.max(s.minDistance,Math.min(s.maxDistance,m.radius)),!0===s.enableDamping?s.target.addScaledVector(y,s.dampingFactor):s.target.add(y),t.setFromSpherical(m),t.applyQuaternion(a),e.copy(s.target).add(t),s.object.lookAt(s.target),!0===s.enableDamping?(f.theta*=1-s.dampingFactor,f.phi*=1-s.dampingFactor,y.multiplyScalar(1-s.dampingFactor)):(f.set(0,0,0),y.set(0,0,0)),g=1,!!(v||l.distanceToSquared(s.object.position)>d||8*(1-u.dot(s.object.quaternion))>d)&&(s.dispatchEvent(c),l.copy(s.object.position),u.copy(s.object.quaternion),v=!1,!0)}}(),this.dispose=function(){s.domElement.removeEventListener("contextmenu",Q),s.domElement.removeEventListener("pointerdown",W),s.domElement.removeEventListener("pointercancel",q),s.domElement.removeEventListener("wheel",Z),s.domElement.removeEventListener("pointermove",Y),s.domElement.removeEventListener("pointerup",X),null!==s._domElementKeyEvents&&s._domElementKeyEvents.removeEventListener("keydown",J)};const s=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let p=n.NONE;const d=1e-6,m=new a.$,f=new a.$;let g=1;const y=new r.P;let v=!1;const T=new l.F,b=new l.F,x=new l.F,E=new l.F,w=new l.F,_=new l.F,M=new l.F,A=new l.F,R=new l.F,S=[],N={};function P(){return Math.pow(.95,s.zoomSpeed)}function I(e){f.theta-=e}function L(e){f.phi-=e}const O=function(){const e=new r.P;return function(t,s){e.setFromMatrixColumn(s,0),e.multiplyScalar(-t),y.add(e)}}(),C=function(){const e=new r.P;return function(t,n){!0===s.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),y.add(e)}}(),k=function(){const e=new r.P;return function(t,n){const r=s.domElement;if(s.object.isPerspectiveCamera){const o=s.object.position;e.copy(o).sub(s.target);let i=e.length();i*=Math.tan(s.object.fov/2*Math.PI/180),O(2*t*i/r.clientHeight,s.object.matrix),C(2*n*i/r.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(O(t*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),C(n*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function F(e){s.object.isPerspectiveCamera?g/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function H(e){s.object.isPerspectiveCamera?g*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function j(e){T.set(e.clientX,e.clientY)}function U(e){E.set(e.clientX,e.clientY)}function V(){if(1===S.length)T.set(S[0].pageX,S[0].pageY);else{const e=.5*(S[0].pageX+S[1].pageX),t=.5*(S[0].pageY+S[1].pageY);T.set(e,t)}}function D(){if(1===S.length)E.set(S[0].pageX,S[0].pageY);else{const e=.5*(S[0].pageX+S[1].pageX),t=.5*(S[0].pageY+S[1].pageY);E.set(e,t)}}function B(){const e=S[0].pageX-S[1].pageX,t=S[0].pageY-S[1].pageY,s=Math.sqrt(e*e+t*t);M.set(0,s)}function G(e){if(1==S.length)b.set(e.pageX,e.pageY);else{const t=te(e),s=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);b.set(s,n)}x.subVectors(b,T).multiplyScalar(s.rotateSpeed);const t=s.domElement;I(2*Math.PI*x.x/t.clientHeight),L(2*Math.PI*x.y/t.clientHeight),T.copy(b)}function z(e){if(1===S.length)w.set(e.pageX,e.pageY);else{const t=te(e),s=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);w.set(s,n)}_.subVectors(w,E).multiplyScalar(s.panSpeed),k(_.x,_.y),E.copy(w)}function K(e){const t=te(e),n=e.pageX-t.x,r=e.pageY-t.y,o=Math.sqrt(n*n+r*r);A.set(0,o),R.set(0,Math.pow(A.y/M.y,s.zoomSpeed)),F(R.y),M.copy(A)}function W(e){!1!==s.enabled&&(0===S.length&&(s.domElement.setPointerCapture(e.pointerId),s.domElement.addEventListener("pointermove",Y),s.domElement.addEventListener("pointerup",X)),function(e){S.push(e)}(e),"touch"===e.pointerType?function(e){switch(ee(e),S.length){case 1:switch(s.touches.ONE){case o.QmN.ROTATE:if(!1===s.enableRotate)return;V(),p=n.TOUCH_ROTATE;break;case o.QmN.PAN:if(!1===s.enablePan)return;D(),p=n.TOUCH_PAN;break;default:p=n.NONE}break;case 2:switch(s.touches.TWO){case o.QmN.DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;s.enableZoom&&B(),s.enablePan&&D(),p=n.TOUCH_DOLLY_PAN;break;case o.QmN.DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;s.enableZoom&&B(),s.enableRotate&&V(),p=n.TOUCH_DOLLY_ROTATE;break;default:p=n.NONE}break;default:p=n.NONE}p!==n.NONE&&s.dispatchEvent(u)}(e):function(e){let t;switch(e.button){case 0:t=s.mouseButtons.LEFT;break;case 1:t=s.mouseButtons.MIDDLE;break;case 2:t=s.mouseButtons.RIGHT;break;default:t=-1}switch(t){case o.RsA.DOLLY:if(!1===s.enableZoom)return;!function(e){M.set(e.clientX,e.clientY)}(e),p=n.DOLLY;break;case o.RsA.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;U(e),p=n.PAN}else{if(!1===s.enableRotate)return;j(e),p=n.ROTATE}break;case o.RsA.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enableRotate)return;j(e),p=n.ROTATE}else{if(!1===s.enablePan)return;U(e),p=n.PAN}break;default:p=n.NONE}p!==n.NONE&&s.dispatchEvent(u)}(e))}function Y(e){!1!==s.enabled&&("touch"===e.pointerType?function(e){switch(ee(e),p){case n.TOUCH_ROTATE:if(!1===s.enableRotate)return;G(e),s.update();break;case n.TOUCH_PAN:if(!1===s.enablePan)return;z(e),s.update();break;case n.TOUCH_DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&K(e),s.enablePan&&z(e)}(e),s.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&K(e),s.enableRotate&&G(e)}(e),s.update();break;default:p=n.NONE}}(e):function(e){if(!1===s.enabled)return;switch(p){case n.ROTATE:if(!1===s.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),x.subVectors(b,T).multiplyScalar(s.rotateSpeed);const t=s.domElement;I(2*Math.PI*x.x/t.clientHeight),L(2*Math.PI*x.y/t.clientHeight),T.copy(b),s.update()}(e);break;case n.DOLLY:if(!1===s.enableZoom)return;!function(e){A.set(e.clientX,e.clientY),R.subVectors(A,M),R.y>0?F(P()):R.y<0&&H(P()),M.copy(A),s.update()}(e);break;case n.PAN:if(!1===s.enablePan)return;!function(e){w.set(e.clientX,e.clientY),_.subVectors(w,E).multiplyScalar(s.panSpeed),k(_.x,_.y),E.copy(w),s.update()}(e)}}(e))}function X(e){$(e),0===S.length&&(s.domElement.releasePointerCapture(e.pointerId),s.domElement.removeEventListener("pointermove",Y),s.domElement.removeEventListener("pointerup",X)),s.dispatchEvent(h),p=n.NONE}function q(e){$(e)}function Z(e){!1!==s.enabled&&!1!==s.enableZoom&&p===n.NONE&&(e.preventDefault(),s.dispatchEvent(u),function(e){e.deltaY<0?H(P()):e.deltaY>0&&F(P()),s.update()}(e),s.dispatchEvent(h))}function J(e){!1!==s.enabled&&!1!==s.enablePan&&function(e){let t=!1;switch(e.code){case s.keys.UP:k(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:k(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:k(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:k(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function Q(e){!1!==s.enabled&&e.preventDefault()}function $(e){delete N[e.pointerId];for(let t=0;t<S.length;t++)if(S[t].pointerId==e.pointerId)return void S.splice(t,1)}function ee(e){let t=N[e.pointerId];void 0===t&&(t=new l.F,N[e.pointerId]=t),t.set(e.pageX,e.pageY)}function te(e){const t=e.pointerId===S[0].pointerId?S[1]:S[0];return N[t.pointerId]}s.domElement.addEventListener("contextmenu",Q),s.domElement.addEventListener("pointerdown",W),s.domElement.addEventListener("pointercancel",q),s.domElement.addEventListener("wheel",Z,{passive:!1}),this.update()}}},7096:(e,t,s)=>{s.d(t,{E:()=>fe});const n="\\[\\]\\.:\\/",r=new RegExp("[\\[\\]\\.:\\/]","g"),o="[^\\[\\]\\.:\\/]",i="[^"+n.replace("\\.","")+"]",a=/((?:WC+[\/:])*)/.source.replace("WC",o),l=/(WCOD+)?/.source.replace("WCOD",i),c=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",o),u=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",o),h=new RegExp("^"+a+l+c+u+"$"),p=["material","materials","bones"];class d{constructor(e,t,s){this.path=t,this.parsedPath=s||d.parseTrackName(t),this.node=d.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,s){return e&&e.isAnimationObjectGroup?new d.Composite(e,t,s):new d(e,t,s)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(r,"")}static parseTrackName(e){const t=h.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const s={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const e=s.nodeName.substring(n+1);-1!==p.indexOf(e)&&(s.nodeName=s.nodeName.substring(0,n),s.objectName=e)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return s}static findNode(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const s=e.skeleton.getBoneByName(t);if(void 0!==s)return s}if(e.children){const s=function(e){for(let n=0;n<e.length;n++){const r=e[n];if(r.name===t||r.uuid===t)return r;const o=s(r.children);if(o)return o}return null},n=s(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const s=this.resolvedProperty;for(let n=0,r=s.length;n!==r;++n)e[t++]=s[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const s=this.resolvedProperty;for(let n=0,r=s.length;n!==r;++n)s[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const s=this.resolvedProperty;for(let n=0,r=s.length;n!==r;++n)s[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const s=this.resolvedProperty;for(let n=0,r=s.length;n!==r;++n)s[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,s=t.objectName,n=t.propertyName;let r=t.propertyIndex;if(e||(e=d.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(s){let n=t.objectIndex;switch(s){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;default:if(void 0===e[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[s]}if(void 0!==n){if(void 0===e[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[n]}}const o=e[n];if(void 0===o){const s=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+s+"."+n+" but it wasn't found.",e)}let i=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?i=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(i=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][i]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}d.Composite=class{constructor(e,t,s){const n=s||d.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();const s=this._targetGroup.nCachedObjects_,n=this._bindings[s];void 0!==n&&n.getValue(e,t)}setValue(e,t){const s=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=s.length;n!==r;++n)s[n].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,s=e.length;t!==s;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,s=e.length;t!==s;++t)e[t].unbind()}},d.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},d.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},d.prototype.GetterByBindingType=[d.prototype._getValue_direct,d.prototype._getValue_array,d.prototype._getValue_arrayElement,d.prototype._getValue_toArray],d.prototype.SetterByBindingTypeAndVersioning=[[d.prototype._setValue_direct,d.prototype._setValue_direct_setNeedsUpdate,d.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[d.prototype._setValue_array,d.prototype._setValue_array_setNeedsUpdate,d.prototype._setValue_array_setMatrixWorldNeedsUpdate],[d.prototype._setValue_arrayElement,d.prototype._setValue_arrayElement_setNeedsUpdate,d.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[d.prototype._setValue_fromArray,d.prototype._setValue_fromArray_setNeedsUpdate,d.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var m=s(1661),f=s(8853),g=s(2547),y=s(1042),v=s(7092);const T={arraySlice:function(e,t,s){return T.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==s?s:e.length)):e.slice(t,s)},convertArray:function(e,t,s){return!e||!s&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,s=new Array(t);for(let e=0;e!==t;++e)s[e]=e;return s.sort((function(t,s){return e[t]-e[s]})),s},sortedArray:function(e,t,s){const n=e.length,r=new e.constructor(n);for(let o=0,i=0;i!==n;++o){const n=s[o]*t;for(let s=0;s!==t;++s)r[i++]=e[n+s]}return r},flattenJSON:function(e,t,s,n){let r=1,o=e[0];for(;void 0!==o&&void 0===o[n];)o=e[r++];if(void 0===o)return;let i=o[n];if(void 0!==i)if(Array.isArray(i))do{i=o[n],void 0!==i&&(t.push(o.time),s.push.apply(s,i)),o=e[r++]}while(void 0!==o);else if(void 0!==i.toArray)do{i=o[n],void 0!==i&&(t.push(o.time),i.toArray(s,s.length)),o=e[r++]}while(void 0!==o);else do{i=o[n],void 0!==i&&(t.push(o.time),s.push(i)),o=e[r++]}while(void 0!==o)},subclip:function(e,t,s,n,r=30){const o=e.clone();o.name=t;const i=[];for(let e=0;e<o.tracks.length;++e){const t=o.tracks[e],a=t.getValueSize(),l=[],c=[];for(let e=0;e<t.times.length;++e){const o=t.times[e]*r;if(!(o<s||o>=n)){l.push(t.times[e]);for(let s=0;s<a;++s)c.push(t.values[e*a+s])}}0!==l.length&&(t.times=T.convertArray(l,t.times.constructor),t.values=T.convertArray(c,t.values.constructor),i.push(t))}o.tracks=i;let a=1/0;for(let e=0;e<o.tracks.length;++e)a>o.tracks[e].times[0]&&(a=o.tracks[e].times[0]);for(let e=0;e<o.tracks.length;++e)o.tracks[e].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(e,t=0,s=e,n=30){n<=0&&(n=30);const r=s.tracks.length,o=t/n;for(let t=0;t<r;++t){const n=s.tracks[t],r=n.ValueTypeName;if("bool"===r||"string"===r)continue;const i=e.tracks.find((function(e){return e.name===n.name&&e.ValueTypeName===r}));if(void 0===i)continue;let a=0;const l=n.getValueSize();n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=n.times.length-1;let p;if(o<=n.times[0]){const e=a,t=l-a;p=T.arraySlice(n.values,e,t)}else if(o>=n.times[h]){const e=h*l+a,t=e+l-a;p=T.arraySlice(n.values,e,t)}else{const e=n.createInterpolant(),t=a,s=l-a;e.evaluate(o),p=T.arraySlice(e.resultBuffer,t,s)}if("quaternion"===r){(new v._).fromArray(p).normalize().conjugate().toArray(p)}const d=i.times.length;for(let e=0;e<d;++e){const t=e*u+c;if("quaternion"===r)v._.multiplyQuaternionsFlat(i.values,t,p,0,i.values,t);else{const e=u-2*c;for(let s=0;s<e;++s)i.values[t+s]-=p[s]}}}return e.blendMode=m.gSk,e}};class b{constructor(e,t,s,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=T.convertArray(t,this.TimeBufferType),this.values=T.convertArray(s,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let s;if(t.toJSON!==this.toJSON)s=t.toJSON(e);else{s={name:e.name,times:T.convertArray(e.times,Array),values:T.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(s.interpolation=t)}return s.type=e.ValueTypeName,s}InterpolantFactoryMethodDiscrete(e){return new y.c(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new g.l(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new f.d(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case m.Syv:t=this.InterpolantFactoryMethodDiscrete;break;case m.NMF:t=this.InterpolantFactoryMethodLinear;break;case m.pIN:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return m.Syv;case this.InterpolantFactoryMethodLinear:return m.NMF;case this.InterpolantFactoryMethodSmooth:return m.pIN}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let s=0,n=t.length;s!==n;++s)t[s]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let s=0,n=t.length;s!==n;++s)t[s]*=e}return this}trim(e,t){const s=this.times,n=s.length;let r=0,o=n-1;for(;r!==n&&s[r]<e;)++r;for(;-1!==o&&s[o]>t;)--o;if(++o,0!==r||o!==n){r>=o&&(o=Math.max(o,1),r=o-1);const e=this.getValueSize();this.times=T.arraySlice(s,r,o),this.values=T.arraySlice(this.values,r*e,o*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const s=this.times,n=this.values,r=s.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let t=0;t!==r;t++){const n=s[t];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,n),e=!1;break}if(null!==o&&o>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,n,o),e=!1;break}o=n}if(void 0!==n&&T.isTypedArray(n))for(let t=0,s=n.length;t!==s;++t){const s=n[t];if(isNaN(s)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,s),e=!1;break}}return e}optimize(){const e=T.arraySlice(this.times),t=T.arraySlice(this.values),s=this.getValueSize(),n=this.getInterpolation()===m.pIN,r=e.length-1;let o=1;for(let i=1;i<r;++i){let r=!1;const a=e[i];if(a!==e[i+1]&&(1!==i||a!==e[0]))if(n)r=!0;else{const e=i*s,n=e-s,o=e+s;for(let i=0;i!==s;++i){const s=t[e+i];if(s!==t[n+i]||s!==t[o+i]){r=!0;break}}}if(r){if(i!==o){e[o]=e[i];const n=i*s,r=o*s;for(let e=0;e!==s;++e)t[r+e]=t[n+e]}++o}}if(r>0){e[o]=e[r];for(let e=r*s,n=o*s,i=0;i!==s;++i)t[n+i]=t[e+i];++o}return o!==e.length?(this.times=T.arraySlice(e,0,o),this.values=T.arraySlice(t,0,o*s)):(this.times=e,this.values=t),this}clone(){const e=T.arraySlice(this.times,0),t=T.arraySlice(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}b.prototype.TimeBufferType=Float32Array,b.prototype.ValueBufferType=Float32Array,b.prototype.DefaultInterpolation=m.NMF;class x extends b{}x.prototype.ValueTypeName="number";var E=s(1950);class w extends b{InterpolantFactoryMethodLinear(e){return new E.z(this.times,this.values,this.getValueSize(),e)}}w.prototype.ValueTypeName="quaternion",w.prototype.DefaultInterpolation=m.NMF,w.prototype.InterpolantFactoryMethodSmooth=void 0;class _ extends b{}_.prototype.ValueTypeName="vector";class M extends b{}M.prototype.ValueTypeName="bool",M.prototype.ValueBufferType=Array,M.prototype.DefaultInterpolation=m.Syv,M.prototype.InterpolantFactoryMethodLinear=void 0,M.prototype.InterpolantFactoryMethodSmooth=void 0;class A extends b{}A.prototype.ValueTypeName="color";class R extends b{}R.prototype.ValueTypeName="string",R.prototype.ValueBufferType=Array,R.prototype.DefaultInterpolation=m.Syv,R.prototype.InterpolantFactoryMethodLinear=void 0,R.prototype.InterpolantFactoryMethodSmooth=void 0;var S=s(2043);class N{constructor(e,t=-1,s,n=m.IFH){this.name=e,this.tracks=s,this.duration=t,this.blendMode=n,this.uuid=S.DO(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],s=e.tracks,n=1/(e.fps||1);for(let e=0,r=s.length;e!==r;++e)t.push(P(s[e]).scale(n));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],s=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,n=s.length;e!==n;++e)t.push(b.toJSON(s[e]));return n}static CreateFromMorphTargetSequence(e,t,s,n){const r=t.length,o=[];for(let e=0;e<r;e++){let i=[],a=[];i.push((e+r-1)%r,e,(e+1)%r),a.push(0,1,0);const l=T.getKeyframeOrder(i);i=T.sortedArray(i,1,l),a=T.sortedArray(a,1,l),n||0!==i[0]||(i.push(r),a.push(a[0])),o.push(new x(".morphTargetInfluences["+t[e].name+"]",i,a).scale(1/s))}return new this(e,-1,o)}static findByName(e,t){let s=e;if(!Array.isArray(e)){const t=e;s=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<s.length;e++)if(s[e].name===t)return s[e];return null}static CreateClipsFromMorphTargetSequences(e,t,s){const n={},r=/^([\w-]*?)([\d]+)$/;for(let t=0,s=e.length;t<s;t++){const s=e[t],o=s.name.match(r);if(o&&o.length>1){const e=o[1];let t=n[e];t||(n[e]=t=[]),t.push(s)}}const o=[];for(const e in n)o.push(this.CreateFromMorphTargetSequence(e,n[e],t,s));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const s=function(e,t,s,n,r){if(0!==s.length){const o=[],i=[];T.flattenJSON(s,o,i,n),0!==o.length&&r.push(new e(t,o,i))}},n=[],r=e.name||"default",o=e.fps||30,i=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const r=l[e].keys;if(r&&0!==r.length)if(r[0].morphTargets){const e={};let t;for(t=0;t<r.length;t++)if(r[t].morphTargets)for(let s=0;s<r[t].morphTargets.length;s++)e[r[t].morphTargets[s]]=-1;for(const s in e){const e=[],o=[];for(let n=0;n!==r[t].morphTargets.length;++n){const n=r[t];e.push(n.time),o.push(n.morphTarget===s?1:0)}n.push(new x(".morphTargetInfluence["+s+"]",e,o))}a=e.length*(o||1)}else{const o=".bones["+t[e].name+"]";s(_,o+".position",r,"pos",n),s(w,o+".quaternion",r,"rot",n),s(_,o+".scale",r,"scl",n)}}if(0===n.length)return null;return new this(r,a,n,i)}resetDuration(){let e=0;for(let t=0,s=this.tracks.length;t!==s;++t){const s=this.tracks[t];e=Math.max(e,s.times[s.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function P(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return x;case"vector":case"vector2":case"vector3":case"vector4":return _;case"color":return A;case"quaternion":return w;case"bool":case"boolean":return M;case"string":return R}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],s=[];T.flattenJSON(e.keys,t,s,"value"),e.times=t,e.values=s}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var I=s(6023),L=s(4948),O=s(5092),C=s(3662),k=s(1514),F=s(8490),H=s(3120),j=s(6173),U=s(8045),V=s(1138),D=s(3914),B=s(8515),G=s(7066),z=s(2980),K=s(2133),W=s(1145),Y=s(140),X=s(4467),q=s(6679),Z=s(4164),J=s(5785),Q=s(9046),$=s(2127),ee=s(6454),te=s(5920),se=s(1301),ne=s(2232),re=s(2306),oe=s(2010),ie=s(1051),ae=s(3131),le=s(7858),ce=s(6469),ue=s(9203),he=s(2170),pe=s(1898),de=s(6881),me=s(4699);class fe extends I.a{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new be(e)})),this.register((function(e){return new Ae(e)})),this.register((function(e){return new Re(e)})),this.register((function(e){return new xe(e)})),this.register((function(e){return new Ee(e)})),this.register((function(e){return new we(e)})),this.register((function(e){return new _e(e)})),this.register((function(e){return new Me(e)})),this.register((function(e){return new ve(e)})),this.register((function(e){return new Se(e)}))}load(e,t,s,n){const r=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:L.Z.extractUrlBase(e),this.manager.itemStart(e);const i=function(t){n?n(t):console.error(t),r.manager.itemError(e),r.manager.itemEnd(e)},a=new O.h(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(s){try{r.parse(s,o,(function(s){t(s),r.manager.itemEnd(e)}),i)}catch(e){i(e)}}),s,i)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,s,n){let r;const o={},i={};if("string"==typeof e)r=e;else{if(L.Z.decodeText(new Uint8Array(e,0,4))===Ne){try{o[ye.KHR_BINARY_GLTF]=new Le(e)}catch(e){return void(n&&n(e))}r=o[ye.KHR_BINARY_GLTF].content}else r=L.Z.decodeText(new Uint8Array(e))}const a=JSON.parse(r);if(void 0===a.asset||a.asset.version[0]<2)return void(n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new ut(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](l);i[t.name]=t,o[t.name]=!0}if(a.extensionsUsed)for(let e=0;e<a.extensionsUsed.length;++e){const t=a.extensionsUsed[e],s=a.extensionsRequired||[];switch(t){case ye.KHR_MATERIALS_UNLIT:o[t]=new Te;break;case ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[t]=new Fe;break;case ye.KHR_DRACO_MESH_COMPRESSION:o[t]=new Oe(a,this.dracoLoader);break;case ye.KHR_TEXTURE_TRANSFORM:o[t]=new Ce;break;case ye.KHR_MESH_QUANTIZATION:o[t]=new He;break;default:s.indexOf(t)>=0&&void 0===i[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(o),l.setPlugins(i),l.parse(s,n)}parseAsync(e,t){const s=this;return new Promise((function(n,r){s.parse(e,t,n,r)}))}}function ge(){let e={};return{get:function(t){return e[t]},add:function(t,s){e[t]=s},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const ye={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class ve{constructor(e){this.parser=e,this.name=ye.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let s=0,n=t.length;s<n;s++){const n=t[s];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){const t=this.parser,s="light:"+e;let n=t.cache.get(s);if(n)return n;const r=t.json,o=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let i;const a=new C.I(16777215);void 0!==o.color&&a.fromArray(o.color);const l=void 0!==o.range?o.range:0;switch(o.type){case"directional":i=new k.O(a),i.target.position.set(0,0,-1),i.add(i.target);break;case"point":i=new F.c(a),i.distance=l;break;case"spot":i=new H.P(a),i.distance=l,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return i.position.set(0,0,0),i.decay=2,void 0!==o.intensity&&(i.intensity=o.intensity),i.name=t.createUniqueName(o.name||"light_"+e),n=Promise.resolve(i),t.cache.add(s,n),n}createNodeAttachment(e){const t=this,s=this.parser,n=s.json.nodes[e],r=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===r?null:this._loadLight(r).then((function(e){return s._getNodeRef(t.cache,r,e)}))}}class Te{constructor(){this.name=ye.KHR_MATERIALS_UNLIT}getMaterialType(){return j.v}extendParams(e,t,s){const n=[];e.color=new C.I(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const t=r.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==r.baseColorTexture&&n.push(s.assignTexture(e,"map",r.baseColorTexture))}return Promise.all(n)}}class be{constructor(e){this.parser=e,this.name=ye.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?U.E:null}extendMaterialParams(e,t){const s=this.parser,n=s.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],o=n.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&r.push(s.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&r.push(s.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(r.push(s.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new V.F(e,e)}return Promise.all(r)}}class xe{constructor(e){this.parser=e,this.name=ye.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?U.E:null}extendMaterialParams(e,t){const s=this.parser,n=s.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new C.I(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=n.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&r.push(s.assignTexture(t,"sheenColorMap",o.sheenColorTexture)),void 0!==o.sheenRoughnessTexture&&r.push(s.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class Ee{constructor(e){this.parser=e,this.name=ye.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?U.E:null}extendMaterialParams(e,t){const s=this.parser,n=s.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],o=n.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&r.push(s.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class we{constructor(e){this.parser=e,this.name=ye.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?U.E:null}extendMaterialParams(e,t){const s=this.parser,n=s.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],o=n.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&r.push(s.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const i=o.attenuationColor||[1,1,1];return t.attenuationColor=new C.I(i[0],i[1],i[2]),Promise.all(r)}}class _e{constructor(e){this.parser=e,this.name=ye.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?U.E:null}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=s.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}class Me{constructor(e){this.parser=e,this.name=ye.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?U.E:null}extendMaterialParams(e,t){const s=this.parser,n=s.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],o=n.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&r.push(s.assignTexture(t,"specularIntensityMap",o.specularTexture));const i=o.specularColorFactor||[1,1,1];return t.specularColor=new C.I(i[0],i[1],i[2]),void 0!==o.specularColorTexture&&r.push(s.assignTexture(t,"specularColorMap",o.specularColorTexture).then((function(e){e.encoding=m.knz}))),Promise.all(r)}}class Ae{constructor(e){this.parser=e,this.name=ye.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,s=t.json,n=s.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const r=n.extensions[this.name],o=s.images[r.source],i=t.options.ktx2Loader;if(!i){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o,i)}}class Re{constructor(e){this.parser=e,this.name=ye.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,s=this.parser,n=s.json,r=n.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],i=n.images[o.source];let a=s.textureLoader;if(i.uri){const e=s.options.manager.getHandler(i.uri);null!==e&&(a=e)}return this.detectSupport().then((function(r){if(r)return s.loadTextureImage(e,i,a);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return s.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class Se{constructor(e){this.name=ye.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,s=t.bufferViews[e];if(s.extensions&&s.extensions[this.name]){const e=s.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([n,r.ready]).then((function(t){const s=e.byteOffset||0,n=e.byteLength||0,o=e.count,i=e.byteStride,a=new ArrayBuffer(o*i),l=new Uint8Array(t[0],s,n);return r.decodeGltfBuffer(new Uint8Array(a),o,i,l,e.mode,e.filter),a}))}return null}}const Ne="glTF",Pe=1313821514,Ie=5130562;class Le{constructor(e){this.name=ye.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:L.Z.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Ne)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-12,n=new DataView(e,12);let r=0;for(;r<s;){const t=n.getUint32(r,!0);r+=4;const s=n.getUint32(r,!0);if(r+=4,s===Pe){const s=new Uint8Array(e,12+r,t);this.content=L.Z.decodeText(s)}else if(s===Ie){const s=12+r;this.body=e.slice(s,s+t)}r+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Oe{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ye.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const s=this.json,n=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,i={},a={},l={};for(const e in o){const t=Qe[e]||e.toLowerCase();i[t]=o[e]}for(const t in e.attributes){const n=Qe[t]||t.toLowerCase();if(void 0!==o[t]){const r=s.accessors[e.attributes[t]],o=Xe[r.componentType];l[n]=o,a[n]=!0===r.normalized}}return t.getDependency("bufferView",r).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(const t in e.attributes){const s=e.attributes[t],n=a[t];void 0!==n&&(s.normalized=n)}t(e)}),i,l)}))}))}}class Ce{constructor(){this.name=ye.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class ke extends D.W{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),r=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),i={specular:{value:(new C.I).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=i,this.onBeforeCompile=function(e){for(const t in i)e.uniforms[t]=i[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",n).replace("#include <metalnessmap_fragment>",r).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return i.specular.value},set:function(e){i.specular.value=e}},specularMap:{get:function(){return i.specularMap.value},set:function(e){i.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return i.glossiness.value},set:function(e){i.glossiness.value=e}},glossinessMap:{get:function(){return i.glossinessMap.value},set:function(e){i.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class Fe{constructor(){this.name=ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return ke}extendParams(e,t,s){const n=t.extensions[this.name];e.color=new C.I(1,1,1),e.opacity=1;const r=[];if(Array.isArray(n.diffuseFactor)){const t=n.diffuseFactor;e.color.fromArray(t),e.opacity=t[3]}if(void 0!==n.diffuseTexture&&r.push(s.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new C.I(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new C.I(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){const t=n.specularGlossinessTexture;r.push(s.assignTexture(e,"glossinessMap",t)),r.push(s.assignTexture(e,"specularMap",t))}return Promise.all(r)}createMaterial(e){const t=new ke(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=m.IOt,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}class He{constructor(){this.name=ye.KHR_MESH_QUANTIZATION}}class je extends B._{constructor(e,t,s,n){super(e,t,s,n)}copySampleValue_(e){const t=this.resultBuffer,s=this.sampleValues,n=this.valueSize,r=e*n*3+n;for(let e=0;e!==n;e++)t[e]=s[r+e];return t}}je.prototype.beforeStart_=je.prototype.copySampleValue_,je.prototype.afterEnd_=je.prototype.copySampleValue_,je.prototype.interpolate_=function(e,t,s,n){const r=this.resultBuffer,o=this.sampleValues,i=this.valueSize,a=2*i,l=3*i,c=n-t,u=(s-t)/c,h=u*u,p=h*u,d=e*l,m=d-l,f=-2*p+3*h,g=p-h,y=1-f,v=g-h+u;for(let e=0;e!==i;e++){const t=o[m+e+i],s=o[m+e+a]*c,n=o[d+e+i],l=o[d+e]*c;r[e]=y*t+v*s+f*n+g*l}return r};const Ue=new v._;class Ve extends je{interpolate_(e,t,s,n){const r=super.interpolate_(e,t,s,n);return Ue.fromArray(r).normalize().toArray(r),r}}const De=0,Be=1,Ge=2,ze=3,Ke=4,We=5,Ye=6,Xe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},qe={9728:m.TyD,9729:m.wem,9984:m.YLQ,9985:m.qyh,9986:m.aH4,9987:m.D1R},Ze={33071:m.uWy,33648:m.OoA,10497:m.rpg},Je={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Qe={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},$e={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},et={CUBICSPLINE:void 0,LINEAR:m.NMF,STEP:m.Syv},tt="OPAQUE",st="MASK",nt="BLEND";function rt(e,t,s){for(const n in s.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=s.extensions[n])}function ot(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function it(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let s=0,n=t.weights.length;s<n;s++)e.morphTargetInfluences[s]=t.weights[s];if(t.extras&&Array.isArray(t.extras.targetNames)){const s=t.extras.targetNames;if(e.morphTargetInfluences.length===s.length){e.morphTargetDictionary={};for(let t=0,n=s.length;t<n;t++)e.morphTargetDictionary[s[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function at(e){const t=e.extensions&&e.extensions[ye.KHR_DRACO_MESH_COMPRESSION];let s;return s=t?"draco:"+t.bufferView+":"+t.indices+":"+lt(t.attributes):e.indices+":"+lt(e.attributes)+":"+e.mode,s}function lt(e){let t="";const s=Object.keys(e).sort();for(let n=0,r=s.length;n<r;n++)t+=s[n]+":"+e[s[n]]+";";return t}function ct(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class ut{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new ge,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new G.Q(this.options.manager):this.textureLoader=new z.d(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new O.h(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const s=this,n=this.json,r=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([s.getDependencies("scene"),s.getDependencies("animation"),s.getDependencies("camera")])})).then((function(t){const o={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:s,userData:{}};rt(r,o,n),ot(o,n),Promise.all(s._invokeAll((function(e){return e.afterRoot&&e.afterRoot(o)}))).then((function(){e(o)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],s=this.json.meshes||[];for(let s=0,n=t.length;s<n;s++){const n=t[s].joints;for(let t=0,s=n.length;t<s;t++)e[n[t]].isBone=!0}for(let t=0,n=e.length;t<n;t++){const n=e[t];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(s[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,s){if(e.refs[t]<=1)return s;const n=s.clone(),r=(e,t)=>{const s=this.associations.get(e);null!=s&&this.associations.set(t,s);for(const[s,n]of e.children.entries())r(n,t.children[s])};return r(s,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let s=0;s<t.length;s++){const n=e(t[s]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const s=[];for(let n=0;n<t.length;n++){const r=e(t[n]);r&&s.push(r)}return s}getDependency(e,t){const s=e+":"+t;let n=this.cache.get(s);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":n=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(s,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const s=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return s.getDependency(e,n)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],s=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[ye.KHR_BINARY_GLTF].body);const n=this.options;return new Promise((function(e,r){s.load(L.Z.resolveURL(t.uri,n.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const s=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+s)}))}loadAccessor(e){const t=this,s=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);const r=[];return void 0!==n.bufferView?r.push(this.getDependency("bufferView",n.bufferView)):r.push(null),void 0!==n.sparse&&(r.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(r).then((function(e){const r=e[0],o=Je[n.type],i=Xe[n.componentType],a=i.BYTES_PER_ELEMENT,l=a*o,c=n.byteOffset||0,u=void 0!==n.bufferView?s.bufferViews[n.bufferView].byteStride:void 0,h=!0===n.normalized;let p,d;if(u&&u!==l){const e=Math.floor(c/u),s="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count;let l=t.cache.get(s);l||(p=new i(r,e*u,n.count*u/a),l=new K.v(p,u/a),t.cache.add(s,l)),d=new W.k(l,o,c%u/a,h)}else p=null===r?new i(n.count*o):new i(r,c,n.count*o),d=new Y.Tl(p,o,h);if(void 0!==n.sparse){const t=Je.SCALAR,s=Xe[n.sparse.indices.componentType],a=n.sparse.indices.byteOffset||0,l=n.sparse.values.byteOffset||0,c=new s(e[1],a,n.sparse.count*t),u=new i(e[2],l,n.sparse.count*o);null!==r&&(d=new Y.Tl(d.array.slice(),d.itemSize,d.normalized));for(let e=0,t=c.length;e<t;e++){const t=c[e];if(d.setX(t,u[e*o]),o>=2&&d.setY(t,u[e*o+1]),o>=3&&d.setZ(t,u[e*o+2]),o>=4&&d.setW(t,u[e*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d}))}loadTexture(e){const t=this.json,s=this.options,n=t.textures[e],r=t.images[n.source];let o=this.textureLoader;if(r.uri){const e=s.manager.getHandler(r.uri);null!==e&&(o=e)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,t,s){const n=this,r=this.json,o=this.options,i=r.textures[e],a=(t.uri||t.bufferView)+":"+i.sampler;if(this.textureCache[a])return this.textureCache[a];const l=self.URL||self.webkitURL;let c=t.uri||"",u=!1;if(void 0!==t.bufferView)c=n.getDependency("bufferView",t.bufferView).then((function(e){u=!0;const s=new Blob([e],{type:t.mimeType});return c=l.createObjectURL(s),c}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(c).then((function(e){return new Promise((function(t,n){let r=t;!0===s.isImageBitmapLoader&&(r=function(e){const s=new X.x(e);s.needsUpdate=!0,t(s)}),s.load(L.Z.resolveURL(e,o.path),r,void 0,n)}))})).then((function(t){!0===u&&l.revokeObjectURL(c),t.flipY=!1,i.name&&(t.name=i.name);const s=(r.samplers||{})[i.sampler]||{};return t.magFilter=qe[s.magFilter]||m.wem,t.minFilter=qe[s.minFilter]||m.D1R,t.wrapS=Ze[s.wrapS]||m.rpg,t.wrapT=Ze[s.wrapT]||m.rpg,n.associations.set(t,{textures:e}),t})).catch((function(){return console.error("THREE.GLTFLoader: Couldn't load texture",c),null}));return this.textureCache[a]=h,h}assignTexture(e,t,s){const n=this;return this.getDependency("texture",s.index).then((function(r){if(void 0===s.texCoord||0==s.texCoord||"aoMap"===t&&1==s.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+s.texCoord+" for texture "+t+" not yet supported."),n.extensions[ye.KHR_TEXTURE_TRANSFORM]){const e=void 0!==s.extensions?s.extensions[ye.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=n.associations.get(r);r=n.extensions[ye.KHR_TEXTURE_TRANSFORM].extendTexture(r,e),n.associations.set(r,t)}}return e[t]=r,r}))}assignFinalMaterial(e){const t=e.geometry;let s=e.material;const n=void 0===t.attributes.tangent,r=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+s.uuid;let t=this.cache.get(e);t||(t=new q.U,Z.F.prototype.copy.call(t,s),t.color.copy(s.color),t.map=s.map,t.sizeAttenuation=!1,this.cache.add(e,t)),s=t}else if(e.isLine){const e="LineBasicMaterial:"+s.uuid;let t=this.cache.get(e);t||(t=new J.n,Z.F.prototype.copy.call(t,s),t.color.copy(s.color),this.cache.add(e,t)),s=t}if(n||r||o){let e="ClonedMaterial:"+s.uuid+":";s.isGLTFSpecularGlossinessMaterial&&(e+="specular-glossiness:"),n&&(e+="derivative-tangents:"),r&&(e+="vertex-colors:"),o&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=s.clone(),r&&(t.vertexColors=!0),o&&(t.flatShading=!0),n&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(s))),s=t}s.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=s}getMaterialType(){return D.W}loadMaterial(e){const t=this,s=this.json,n=this.extensions,r=s.materials[e];let o;const i={},a=r.extensions||{},l=[];if(a[ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const e=n[ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=e.getMaterialType(),l.push(e.extendParams(i,r,t))}else if(a[ye.KHR_MATERIALS_UNLIT]){const e=n[ye.KHR_MATERIALS_UNLIT];o=e.getMaterialType(),l.push(e.extendParams(i,r,t))}else{const s=r.pbrMetallicRoughness||{};if(i.color=new C.I(1,1,1),i.opacity=1,Array.isArray(s.baseColorFactor)){const e=s.baseColorFactor;i.color.fromArray(e),i.opacity=e[3]}void 0!==s.baseColorTexture&&l.push(t.assignTexture(i,"map",s.baseColorTexture)),i.metalness=void 0!==s.metallicFactor?s.metallicFactor:1,i.roughness=void 0!==s.roughnessFactor?s.roughnessFactor:1,void 0!==s.metallicRoughnessTexture&&(l.push(t.assignTexture(i,"metalnessMap",s.metallicRoughnessTexture)),l.push(t.assignTexture(i,"roughnessMap",s.metallicRoughnessTexture))),o=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),l.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,i)}))))}!0===r.doubleSided&&(i.side=m.ehD);const c=r.alphaMode||tt;if(c===nt?(i.transparent=!0,i.depthWrite=!1):(i.format=m.UCm,i.transparent=!1,c===st&&(i.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&o!==j.v&&(l.push(t.assignTexture(i,"normalMap",r.normalTexture)),i.normalScale=new V.F(1,1),void 0!==r.normalTexture.scale)){const e=r.normalTexture.scale;i.normalScale.set(e,e)}return void 0!==r.occlusionTexture&&o!==j.v&&(l.push(t.assignTexture(i,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(i.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&o!==j.v&&(i.emissive=(new C.I).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&o!==j.v&&l.push(t.assignTexture(i,"emissiveMap",r.emissiveTexture)),Promise.all(l).then((function(){let s;return s=o===ke?n[ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(i):new o(i),r.name&&(s.name=r.name),s.map&&(s.map.encoding=m.knz),s.emissiveMap&&(s.emissiveMap.encoding=m.knz),ot(s,r),t.associations.set(s,{materials:e}),r.extensions&&rt(n,s,r),s}))}createUniqueName(e){const t=d.sanitizeNodeName(e||"");let s=t;for(let e=1;this.nodeNamesUsed[s];++e)s=t+"_"+e;return this.nodeNamesUsed[s]=!0,s}loadGeometries(e){const t=this,s=this.extensions,n=this.primitiveCache;function r(e){return s[ye.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(s){return pt(s,e,t)}))}const o=[];for(let s=0,i=e.length;s<i;s++){const i=e[s],a=at(i),l=n[a];if(l)o.push(l.promise);else{let e;e=i.extensions&&i.extensions[ye.KHR_DRACO_MESH_COMPRESSION]?r(i):pt(new Q.u,i,t),n[a]={primitive:i,promise:e},o.push(e)}}return Promise.all(o)}loadMesh(e){const t=this,s=this.json,n=this.extensions,r=s.meshes[e],o=r.primitives,i=[];for(let e=0,t=o.length;e<t;e++){const t=void 0===o[e].material?(void 0===(a=this.cache).DefaultMaterial&&(a.DefaultMaterial=new D.W({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:m.Wl3})),a.DefaultMaterial):this.getDependency("material",o[e].material);i.push(t)}var a;return i.push(t.loadGeometries(o)),Promise.all(i).then((function(s){const i=s.slice(0,s.length-1),a=s[s.length-1],l=[];for(let s=0,c=a.length;s<c;s++){const c=a[s],u=o[s];let h;const p=i[s];if(u.mode===Ke||u.mode===We||u.mode===Ye||void 0===u.mode)h=!0===r.isSkinnedMesh?new $.T(c,p):new ee.K(c,p),!0!==h.isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),u.mode===We?h.geometry=dt(h.geometry,m.UlW):u.mode===Ye&&(h.geometry=dt(h.geometry,m.z$h));else if(u.mode===Be)h=new te.e(c,p);else if(u.mode===ze)h=new se.x(c,p);else if(u.mode===Ge)h=new ne.b(c,p);else{if(u.mode!==De)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);h=new re.w(c,p)}Object.keys(h.geometry.morphAttributes).length>0&&it(h,r),h.name=t.createUniqueName(r.name||"mesh_"+e),ot(h,r),u.extensions&&rt(n,h,u),t.assignFinalMaterial(h),l.push(h)}for(let s=0,n=l.length;s<n;s++)t.associations.set(l[s],{meshes:e,primitives:s});if(1===l.length)return l[0];const c=new oe.Z;t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c}))}loadCamera(e){let t;const s=this.json.cameras[e],n=s[s.type];if(n)return"perspective"===s.type?t=new ie.c(S.ZY(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===s.type&&(t=new ae.i(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),s.name&&(t.name=this.createUniqueName(s.name)),ot(t,s),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],s={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(s):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return s.inverseBindMatrices=e,s}))}loadAnimation(e){const t=this.json.animations[e],s=[],n=[],r=[],o=[],i=[];for(let e=0,a=t.channels.length;e<a;e++){const a=t.channels[e],l=t.samplers[a.sampler],c=a.target,u=void 0!==c.node?c.node:c.id,h=void 0!==t.parameters?t.parameters[l.input]:l.input,p=void 0!==t.parameters?t.parameters[l.output]:l.output;s.push(this.getDependency("node",u)),n.push(this.getDependency("accessor",h)),r.push(this.getDependency("accessor",p)),o.push(l),i.push(c)}return Promise.all([Promise.all(s),Promise.all(n),Promise.all(r),Promise.all(o),Promise.all(i)]).then((function(s){const n=s[0],r=s[1],o=s[2],i=s[3],a=s[4],l=[];for(let e=0,t=n.length;e<t;e++){const t=n[e],s=r[e],c=o[e],u=i[e],h=a[e];if(void 0===t)continue;let p;switch(t.updateMatrix(),t.matrixAutoUpdate=!0,$e[h.path]){case $e.weights:p=x;break;case $e.rotation:p=w;break;default:p=_}const d=t.name?t.name:t.uuid,f=void 0!==u.interpolation?et[u.interpolation]:m.NMF,g=[];$e[h.path]===$e.weights?t.traverse((function(e){e.morphTargetInfluences&&g.push(e.name?e.name:e.uuid)})):g.push(d);let y=c.array;if(c.normalized){const e=ct(y.constructor),t=new Float32Array(y.length);for(let s=0,n=y.length;s<n;s++)t[s]=y[s]*e;y=t}for(let e=0,t=g.length;e<t;e++){const t=new p(g[e]+"."+$e[h.path],s.array,y,f);"CUBICSPLINE"===u.interpolation&&(t.createInterpolant=function(e){return new(this instanceof w?Ve:je)(this.times,this.values,this.getValueSize()/3,e)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(t)}}const c=t.name?t.name:"animation_"+e;return new N(c,void 0,l)}))}createNodeMesh(e){const t=this.json,s=this,n=t.nodes[e];return void 0===n.mesh?null:s.getDependency("mesh",n.mesh).then((function(e){const t=s._getNodeRef(s.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,s=n.weights.length;t<s;t++)e.morphTargetInfluences[t]=n.weights[t]})),t}))}loadNode(e){const t=this.json,s=this.extensions,n=this,r=t.nodes[e],o=r.name?n.createUniqueName(r.name):"";return function(){const t=[],s=n._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return s&&t.push(s),void 0!==r.camera&&t.push(n.getDependency("camera",r.camera).then((function(e){return n._getNodeRef(n.cameraCache,r.camera,e)}))),n._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){let i;if(i=!0===r.isBone?new le.N:t.length>1?new oe.Z:1===t.length?t[0]:new ce.T,i!==t[0])for(let e=0,s=t.length;e<s;e++)i.add(t[e]);if(r.name&&(i.userData.name=r.name,i.name=o),ot(i,r),r.extensions&&rt(s,i,r),void 0!==r.matrix){const e=new ue.y;e.fromArray(r.matrix),i.applyMatrix4(e)}else void 0!==r.translation&&i.position.fromArray(r.translation),void 0!==r.rotation&&i.quaternion.fromArray(r.rotation),void 0!==r.scale&&i.scale.fromArray(r.scale);return n.associations.has(i)||n.associations.set(i,{}),n.associations.get(i).nodes=e,i}))}loadScene(e){const t=this.json,s=this.extensions,n=this.json.scenes[e],r=this,o=new oe.Z;n.name&&(o.name=r.createUniqueName(n.name)),ot(o,n),n.extensions&&rt(s,o,n);const i=n.nodes||[],a=[];for(let e=0,s=i.length;e<s;e++)a.push(ht(i[e],o,t,r));return Promise.all(a).then((function(){return r.associations=(e=>{const t=new Map;for(const[e,s]of r.associations)(e instanceof Z.F||e instanceof X.x)&&t.set(e,s);return e.traverse((e=>{const s=r.associations.get(e);null!=s&&t.set(e,s)})),t})(o),o}))}}function ht(e,t,s,n){const r=s.nodes[e];return n.getDependency("node",e).then((function(e){if(void 0===r.skin)return e;let t;return n.getDependency("skin",r.skin).then((function(e){t=e;const s=[];for(let e=0,r=t.joints.length;e<r;e++)s.push(n.getDependency("node",t.joints[e]));return Promise.all(s)})).then((function(s){return e.traverse((function(e){if(!e.isMesh)return;const n=[],r=[];for(let e=0,o=s.length;e<o;e++){const o=s[e];if(o){n.push(o);const s=new ue.y;void 0!==t.inverseBindMatrices&&s.fromArray(t.inverseBindMatrices.array,16*e),r.push(s)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[e])}e.bind(new he.O(n,r),e.matrixWorld)})),e}))})).then((function(e){t.add(e);const o=[];if(r.children){const t=r.children;for(let r=0,i=t.length;r<i;r++){const i=t[r];o.push(ht(i,e,s,n))}}return Promise.all(o)}))}function pt(e,t,s){const n=t.attributes,r=[];function o(t,n){return s.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(const t in n){const s=Qe[t]||t.toLowerCase();s in e.attributes||r.push(o(n[t],s))}if(void 0!==t.indices&&!e.index){const n=s.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));r.push(n)}return ot(e,t),function(e,t,s){const n=t.attributes,r=new pe.Z;if(void 0===n.POSITION)return;{const e=s.json.accessors[n.POSITION],t=e.min,o=e.max;if(void 0===t||void 0===o)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new de.P(t[0],t[1],t[2]),new de.P(o[0],o[1],o[2])),e.normalized){const t=ct(Xe[e.componentType]);r.min.multiplyScalar(t),r.max.multiplyScalar(t)}}const o=t.targets;if(void 0!==o){const e=new de.P,t=new de.P;for(let n=0,r=o.length;n<r;n++){const r=o[n];if(void 0!==r.POSITION){const n=s.json.accessors[r.POSITION],o=n.min,i=n.max;if(void 0!==o&&void 0!==i){if(t.setX(Math.max(Math.abs(o[0]),Math.abs(i[0]))),t.setY(Math.max(Math.abs(o[1]),Math.abs(i[1]))),t.setZ(Math.max(Math.abs(o[2]),Math.abs(i[2]))),n.normalized){const e=ct(Xe[n.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(e)}e.boundingBox=r;const i=new me.a;r.getCenter(i.center),i.radius=r.min.distanceTo(r.max)/2,e.boundingSphere=i}(e,t,s),Promise.all(r).then((function(){return void 0!==t.targets?function(e,t,s){let n=!1,r=!1;for(let e=0,s=t.length;e<s;e++){const s=t[e];if(void 0!==s.POSITION&&(n=!0),void 0!==s.NORMAL&&(r=!0),n&&r)break}if(!n&&!r)return Promise.resolve(e);const o=[],i=[];for(let a=0,l=t.length;a<l;a++){const l=t[a];if(n){const t=void 0!==l.POSITION?s.getDependency("accessor",l.POSITION):e.attributes.position;o.push(t)}if(r){const t=void 0!==l.NORMAL?s.getDependency("accessor",l.NORMAL):e.attributes.normal;i.push(t)}}return Promise.all([Promise.all(o),Promise.all(i)]).then((function(t){const s=t[0],o=t[1];return n&&(e.morphAttributes.position=s),r&&(e.morphAttributes.normal=o),e.morphTargetsRelative=!0,e}))}(e,t.targets,s):e}))}function dt(e,t){let s=e.getIndex();if(null===s){const t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),s=e.getIndex()}const n=s.count-2,r=[];if(t===m.z$h)for(let e=1;e<=n;e++)r.push(s.getX(0)),r.push(s.getX(e)),r.push(s.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(r.push(s.getX(e)),r.push(s.getX(e+1)),r.push(s.getX(e+2))):(r.push(s.getX(e+2)),r.push(s.getX(e+1)),r.push(s.getX(e)));r.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=e.clone();return o.setIndex(r),o}}}]);