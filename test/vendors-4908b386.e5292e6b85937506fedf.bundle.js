"use strict";(self.webpackChunkouterspace_webpack=self.webpackChunkouterspace_webpack||[]).push([[444],{7761:(t,e,i)=>{i.d(e,{M:()=>f});var n=i(8719),a=i(7406),r=i(1051),s=i(6881),o=i(223),l=i(924),h=i(4302),p=i(2010);const u={type:"move"};class c{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new p.Z,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new p.Z,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new s.P,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new s.P),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new p.Z,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new s.P,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new s.P),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,i){let n=null,a=null,r=null;const s=this._targetRay,o=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==s&&(n=e.getPose(t.targetRaySpace,i),null!==n&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),n.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(n.linearVelocity)):s.hasLinearVelocity=!1,n.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(n.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(u))),l&&t.hand){r=!0;for(const n of t.hand.values()){const t=e.getJointPose(n,i);if(void 0===l.joints[n.jointName]){const t=new p.Z;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[n.jointName]=t,l.add(t)}const a=l.joints[n.jointName];null!==t&&(a.matrix.fromArray(t.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.jointRadius=t.radius),a.visible=null!==t}const n=l.joints["index-finger-tip"],a=l.joints["thumb-tip"],s=n.position.distanceTo(a.position),o=.02,h=.005;l.inputState.pinching&&s>o+h?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&s<=o-h&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&t.gripSpace&&(a=e.getPose(t.gripSpace,i),null!==a&&(o.matrix.fromArray(a.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),a.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(a.linearVelocity)):o.hasLinearVelocity=!1,a.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(a.angularVelocity)):o.hasAngularVelocity=!1));return null!==s&&(s.visible=null!==n),null!==o&&(o.visible=null!==a),null!==l&&(l.visible=null!==r),this}}var d=i(4467),g=i(1661);class m extends d.x{constructor(t,e,i,n,a,r,s,o,l,h){if((h=void 0!==h?h:g.qkB)!==g.qkB&&h!==g.brP)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&h===g.qkB&&(i=g.LsT),void 0===i&&h===g.brP&&(i=g.wJv),super(null,n,a,r,s,o,h,i,l),this.image={width:t,height:e},this.magFilter=void 0!==s?s:g.TyD,this.minFilter=void 0!==o?o:g.TyD,this.flipY=!1,this.generateMipmaps=!1}}m.prototype.isDepthTexture=!0;var y=i(8449);class f extends a.p{constructor(t,e){super();const i=this;let a=null,p=1,u=null,d="local-floor";const f=t.extensions.has("WEBGL_multisampled_render_to_texture");let x=null,v=null,w=null,T=null,_=!1,b=null;const E=e.getContextAttributes();let S=null,A=null;const R=[],F=new Map,M=new r.c;M.layers.enable(1),M.viewport=new o.L;const L=new r.c;L.layers.enable(2),L.viewport=new o.L;const V=[M,L],D=new n.H;D.layers.enable(1),D.layers.enable(2);let W=null,k=null;function P(t){const e=F.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function U(){F.forEach((function(t,e){t.disconnect(e)})),F.clear(),W=null,k=null,t.setRenderTarget(S),T=null,w=null,v=null,a=null,A=null,q.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function j(t){const e=a.inputSources;for(let t=0;t<R.length;t++)F.set(e[t],R[t]);for(let e=0;e<t.removed.length;e++){const i=t.removed[e],n=F.get(i);n&&(n.dispatchEvent({type:"disconnected",data:i}),F.delete(i))}for(let e=0;e<t.added.length;e++){const i=t.added[e],n=F.get(i);n&&n.dispatchEvent({type:"connected",data:i})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=R[t];return void 0===e&&(e=new c,R[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=R[t];return void 0===e&&(e=new c,R[t]=e),e.getGripSpace()},this.getHand=function(t){let e=R[t];return void 0===e&&(e=new c,R[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){p=t,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){d=t,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u},this.getBaseLayer=function(){return null!==w?w:T},this.getBinding=function(){return v},this.getFrame=function(){return b},this.getSession=function(){return a},this.setSession=async function(n){if(a=n,null!==a){if(S=t.getRenderTarget(),a.addEventListener("select",P),a.addEventListener("selectstart",P),a.addEventListener("selectend",P),a.addEventListener("squeeze",P),a.addEventListener("squeezestart",P),a.addEventListener("squeezeend",P),a.addEventListener("end",U),a.addEventListener("inputsourceschange",j),!0!==E.xrCompatible&&await e.makeXRCompatible(),void 0===a.renderState.layers||!1===t.capabilities.isWebGL2){const t={antialias:void 0!==a.renderState.layers||E.antialias,alpha:E.alpha,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:p};T=new XRWebGLLayer(a,e,t),a.updateRenderState({baseLayer:T}),A=new h.d(T.framebufferWidth,T.framebufferHeight)}else{_=E.antialias;let t=null,i=null,n=null;E.depth&&(n=E.stencil?35056:33189,t=E.stencil?g.brP:g.qkB,i=E.stencil?g.wJv:g.LsT);const r={colorFormat:E.alpha||_?32856:32849,depthFormat:n,scaleFactor:p};v=new XRWebGLBinding(a,e),w=v.createProjectionLayer(r),a.updateRenderState({layers:[w]}),A=_?new y.p(w.textureWidth,w.textureHeight,{format:g.wk1,type:g.ywz,depthTexture:new m(w.textureWidth,w.textureHeight,i,void 0,void 0,void 0,void 0,void 0,void 0,t),stencilBuffer:E.stencil,ignoreDepth:w.ignoreDepthValues,useRenderToTexture:f}):new h.d(w.textureWidth,w.textureHeight,{format:E.alpha?g.wk1:g.UCm,type:g.ywz,depthTexture:new m(w.textureWidth,w.textureHeight,i,void 0,void 0,void 0,void 0,void 0,void 0,t),stencilBuffer:E.stencil,ignoreDepth:w.ignoreDepthValues})}this.setFoveation(0),u=await a.requestReferenceSpace(d),q.setContext(a),q.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};const H=new s.P,C=new s.P;function O(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===a)return;D.near=L.near=M.near=t.near,D.far=L.far=M.far=t.far,W===D.near&&k===D.far||(a.updateRenderState({depthNear:D.near,depthFar:D.far}),W=D.near,k=D.far);const e=t.parent,i=D.cameras;O(D,e);for(let t=0;t<i.length;t++)O(i[t],e);D.matrixWorld.decompose(D.position,D.quaternion,D.scale),t.position.copy(D.position),t.quaternion.copy(D.quaternion),t.scale.copy(D.scale),t.matrix.copy(D.matrix),t.matrixWorld.copy(D.matrixWorld);const n=t.children;for(let t=0,e=n.length;t<e;t++)n[t].updateMatrixWorld(!0);2===i.length?function(t,e,i){H.setFromMatrixPosition(e.matrixWorld),C.setFromMatrixPosition(i.matrixWorld);const n=H.distanceTo(C),a=e.projectionMatrix.elements,r=i.projectionMatrix.elements,s=a[14]/(a[10]-1),o=a[14]/(a[10]+1),l=(a[9]+1)/a[5],h=(a[9]-1)/a[5],p=(a[8]-1)/a[0],u=(r[8]+1)/r[0],c=s*p,d=s*u,g=n/(-p+u),m=g*-p;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(g),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const y=s+g,f=o+g,x=c-m,v=d+(n-m),w=l*o/f*y,T=h*o/f*y;t.projectionMatrix.makePerspective(x,v,w,T,y,f)}(D,M,L):D.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return D},this.getFoveation=function(){return null!==w?w.fixedFoveation:null!==T?T.fixedFoveation:void 0},this.setFoveation=function(t){null!==w&&(w.fixedFoveation=t),null!==T&&void 0!==T.fixedFoveation&&(T.fixedFoveation=t)};let N=null;const q=new l.C;q.setAnimationLoop((function(e,i){if(x=i.getViewerPose(u),b=i,null!==x){const e=x.views;null!==T&&(t.setRenderTargetFramebuffer(A,T.framebuffer),t.setRenderTarget(A));let i=!1;e.length!==D.cameras.length&&(D.cameras.length=0,i=!0);for(let n=0;n<e.length;n++){const a=e[n];let r=null;if(null!==T)r=T.getViewport(a);else{const e=v.getViewSubImage(w,a);r=e.viewport,0===n&&(t.setRenderTargetTextures(A,e.colorTexture,w.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(A))}const s=V[n];s.matrix.fromArray(a.transform.matrix),s.projectionMatrix.fromArray(a.projectionMatrix),s.viewport.set(r.x,r.y,r.width,r.height),0===n&&D.matrix.copy(s.matrix),!0===i&&D.cameras.push(s)}}const n=a.inputSources;for(let t=0;t<R.length;t++){const e=R[t],a=n[t];e.update(a,i,u)}N&&N(e,i),b=null})),this.setAnimationLoop=function(t){N=t},this.dispose=function(){}}}},7365:(t,e,i)=>{i.d(e,{x:()=>a});var n=i(6469);class a extends n.T{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}a.prototype.isScene=!0},3882:(t,e,i)=>{i.d(e,{B:()=>r});var n=i(4467),a=i(1661);class r extends n.x{constructor(t,e,i,n,r,s,o,l,h,p){super(t=void 0!==t?t:[],e=void 0!==e?e:a.fY$,i,n,r,s,o,l,h,p),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}r.prototype.isCubeTexture=!0},5491:(t,e,i)=>{i.d(e,{C:()=>r});var n=i(4467),a=i(1661);class r extends n.x{constructor(t=null,e=1,i=1,n=1){super(null),this.image={data:t,width:e,height:i,depth:n},this.magFilter=a.TyD,this.minFilter=a.TyD,this.wrapR=a.uWy,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}r.prototype.isDataTexture2DArray=!0},7962:(t,e,i)=>{i.d(e,{z:()=>r});var n=i(4467),a=i(1661);class r extends n.x{constructor(t=null,e=1,i=1,n=1){super(null),this.image={data:t,width:e,height:i,depth:n},this.magFilter=a.TyD,this.minFilter=a.TyD,this.wrapR=a.uWy,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}r.prototype.isDataTexture3D=!0},4467:(t,e,i)=>{i.d(e,{x:()=>p});var n=i(7406),a=i(1661),r=i(2043),s=i(1138),o=i(1273),l=i(5006);let h=0;class p extends n.p{constructor(t=p.DEFAULT_IMAGE,e=p.DEFAULT_MAPPING,i=a.uWy,n=a.uWy,l=a.wem,u=a.D1R,c=a.wk1,d=a.ywz,g=1,m=a.rnI){super(),Object.defineProperty(this,"id",{value:h++}),this.uuid=r.DO(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=i,this.wrapT=n,this.magFilter=l,this.minFilter=u,this.anisotropy=g,this.format=c,this.internalFormat=null,this.type=d,this.offset=new s.F(0,0),this.repeat=new s.F(1,1),this.center=new s.F(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new o.V,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const n=this.image;if(void 0===n.uuid&&(n.uuid=r.DO()),!e&&void 0===t.images[n.uuid]){let e;if(Array.isArray(n)){e=[];for(let t=0,i=n.length;t<i;t++)n[t].isDataTexture?e.push(u(n[t].image)):e.push(u(n[t]))}else e=u(n);t.images[n.uuid]={uuid:n.uuid,url:e}}i.image=n.uuid}return"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==a.xfE)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case a.rpg:t.x=t.x-Math.floor(t.x);break;case a.uWy:t.x=t.x<0?0:1;break;case a.OoA:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case a.rpg:t.y=t.y-Math.floor(t.y);break;case a.uWy:t.y=t.y<0?0:1;break;case a.OoA:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&this.version++}}function u(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?l.P.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}p.DEFAULT_IMAGE=void 0,p.DEFAULT_MAPPING=a.xfE,p.prototype.isTexture=!0}}]);