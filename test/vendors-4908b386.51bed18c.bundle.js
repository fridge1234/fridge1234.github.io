"use strict";(self.webpackChunkouterspace_webpack=self.webpackChunkouterspace_webpack||[]).push([[444],{3245:(e,t,n)=>{n.d(t,{M:()=>y});var i=n(8719),a=n(7406),r=n(1051),o=n(6881),s=n(223),l=n(924),c=n(4302),u=n(2010);const d={type:"move"};class h{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new u.Z,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new u.Z,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new o.P,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new o.P),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new u.Z,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new o.P,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new o.P),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,a=null,r=null;const o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==o&&(i=t.getPose(e.targetRaySpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(d))),l&&e.hand){r=!0;for(const i of e.hand.values()){const e=t.getJointPose(i,n);if(void 0===l.joints[i.jointName]){const e=new u.Z;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[i.jointName]=e,l.add(e)}const a=l.joints[i.jointName];null!==e&&(a.matrix.fromArray(e.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.jointRadius=e.radius),a.visible=null!==e}const i=l.joints["index-finger-tip"],a=l.joints["thumb-tip"],o=i.position.distanceTo(a.position),s=.02,c=.005;l.inputState.pinching&&o>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&(a=t.getPose(e.gripSpace,n),null!==a&&(s.matrix.fromArray(a.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),a.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(a.linearVelocity)):s.hasLinearVelocity=!1,a.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(a.angularVelocity)):s.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==i),null!==s&&(s.visible=null!==a),null!==l&&(l.visible=null!==r),this}}var p=n(2638),g=n(8449),f=n(1661);class y extends a.p{constructor(e,t){super();const n=this;let a=null,u=1,d=null,y="local-floor";const m=e.extensions.has("WEBGL_multisampled_render_to_texture");let v=null,x=null,_=null,w=null,b=!1,R=null;const S=t.getContextAttributes();let V=null,E=null;const L=[],T=new Map,W=new r.c;W.layers.enable(1),W.viewport=new s.L;const A=new r.c;A.layers.enable(2),A.viewport=new s.L;const P=[W,A],j=new i.H;j.layers.enable(1),j.layers.enable(2);let F=null,M=null;function k(e){const t=T.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function C(){T.forEach((function(e,t){e.disconnect(t)})),T.clear(),F=null,M=null,e.setRenderTarget(V),w=null,_=null,x=null,a=null,E=null,G.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function H(e){const t=a.inputSources;for(let e=0;e<L.length;e++)T.set(t[e],L[e]);for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=T.get(n);i&&(i.dispatchEvent({type:"disconnected",data:n}),T.delete(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t],i=T.get(n);i&&i.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=L[e];return void 0===t&&(t=new h,L[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=L[e];return void 0===t&&(t=new h,L[e]=t),t.getGripSpace()},this.getHand=function(e){let t=L[e];return void 0===t&&(t=new h,L[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){u=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){y=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d},this.getBaseLayer=function(){return null!==_?_:w},this.getBinding=function(){return x},this.getFrame=function(){return R},this.getSession=function(){return a},this.setSession=async function(i){if(a=i,null!==a){if(V=e.getRenderTarget(),a.addEventListener("select",k),a.addEventListener("selectstart",k),a.addEventListener("selectend",k),a.addEventListener("squeeze",k),a.addEventListener("squeezestart",k),a.addEventListener("squeezeend",k),a.addEventListener("end",C),a.addEventListener("inputsourceschange",H),!0!==S.xrCompatible&&await t.makeXRCompatible(),void 0===a.renderState.layers||!1===e.capabilities.isWebGL2){const e={antialias:void 0!==a.renderState.layers||S.antialias,alpha:S.alpha,depth:S.depth,stencil:S.stencil,framebufferScaleFactor:u};w=new XRWebGLLayer(a,t,e),a.updateRenderState({baseLayer:w}),E=new c.d(w.framebufferWidth,w.framebufferHeight)}else{b=S.antialias;let e=null,n=null,i=null;S.depth&&(i=S.stencil?35056:33189,e=S.stencil?f.brP:f.qkB,n=S.stencil?f.wJv:f.LsT);const r={colorFormat:S.alpha||b?32856:32849,depthFormat:i,scaleFactor:u};x=new XRWebGLBinding(a,t),_=x.createProjectionLayer(r),a.updateRenderState({layers:[_]}),E=b?new g.p(_.textureWidth,_.textureHeight,{format:f.wk1,type:f.ywz,depthTexture:new p.$(_.textureWidth,_.textureHeight,n,void 0,void 0,void 0,void 0,void 0,void 0,e),stencilBuffer:S.stencil,ignoreDepth:_.ignoreDepthValues,useRenderToTexture:m}):new c.d(_.textureWidth,_.textureHeight,{format:S.alpha?f.wk1:f.UCm,type:f.ywz,depthTexture:new p.$(_.textureWidth,_.textureHeight,n,void 0,void 0,void 0,void 0,void 0,void 0,e),stencilBuffer:S.stencil,ignoreDepth:_.ignoreDepthValues})}this.setFoveation(0),d=await a.requestReferenceSpace(y),G.setContext(a),G.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const U=new o.P,q=new o.P;function B(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===a)return;j.near=A.near=W.near=e.near,j.far=A.far=W.far=e.far,F===j.near&&M===j.far||(a.updateRenderState({depthNear:j.near,depthFar:j.far}),F=j.near,M=j.far);const t=e.parent,n=j.cameras;B(j,t);for(let e=0;e<n.length;e++)B(n[e],t);j.matrixWorld.decompose(j.position,j.quaternion,j.scale),e.position.copy(j.position),e.quaternion.copy(j.quaternion),e.scale.copy(j.scale),e.matrix.copy(j.matrix),e.matrixWorld.copy(j.matrixWorld);const i=e.children;for(let e=0,t=i.length;e<t;e++)i[e].updateMatrixWorld(!0);2===n.length?function(e,t,n){U.setFromMatrixPosition(t.matrixWorld),q.setFromMatrixPosition(n.matrixWorld);const i=U.distanceTo(q),a=t.projectionMatrix.elements,r=n.projectionMatrix.elements,o=a[14]/(a[10]-1),s=a[14]/(a[10]+1),l=(a[9]+1)/a[5],c=(a[9]-1)/a[5],u=(a[8]-1)/a[0],d=(r[8]+1)/r[0],h=o*u,p=o*d,g=i/(-u+d),f=g*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(g),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const y=o+g,m=s+g,v=h-f,x=p+(i-f),_=l*s/m*y,w=c*s/m*y;e.projectionMatrix.makePerspective(v,x,_,w,y,m)}(j,W,A):j.projectionMatrix.copy(W.projectionMatrix)},this.getCamera=function(){return j},this.getFoveation=function(){return null!==_?_.fixedFoveation:null!==w?w.fixedFoveation:void 0},this.setFoveation=function(e){null!==_&&(_.fixedFoveation=e),null!==w&&void 0!==w.fixedFoveation&&(w.fixedFoveation=e)};let D=null;const G=new l.C;G.setAnimationLoop((function(t,n){if(v=n.getViewerPose(d),R=n,null!==v){const t=v.views;null!==w&&(e.setRenderTargetFramebuffer(E,w.framebuffer),e.setRenderTarget(E));let n=!1;t.length!==j.cameras.length&&(j.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){const a=t[i];let r=null;if(null!==w)r=w.getViewport(a);else{const t=x.getViewSubImage(_,a);r=t.viewport,0===i&&(e.setRenderTargetTextures(E,t.colorTexture,_.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(E))}const o=P[i];o.matrix.fromArray(a.transform.matrix),o.projectionMatrix.fromArray(a.projectionMatrix),o.viewport.set(r.x,r.y,r.width,r.height),0===i&&j.matrix.copy(o.matrix),!0===n&&j.cameras.push(o)}}const i=a.inputSources;for(let e=0;e<L.length;e++){const t=L[e],a=i[e];t.update(a,n,d)}D&&D(t,n),R=null})),this.setAnimationLoop=function(e){D=e},this.dispose=function(){}}}},7365:(e,t,n)=>{n.d(t,{x:()=>a});var i=n(6469);class a extends i.T{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}a.prototype.isScene=!0}}]);